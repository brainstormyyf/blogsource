---
title: 第六章：系统总线
date: 2024-02-24T20:52:51+08:00
draft: false
linkTitle: 系统总线
series: 
nav_weight: 6
type: docs
authors:
  - YYF
---

<!--more-->


## 六、总线概述

### 1. 总线的基本概念

- 同一时刻只允许有一个部件向总线发出信息
- 主设备是指获得总线控制权的设备；从设备是指被主设备访问的设备且只能被动响应各种总线命令

### 2. 总线的分类

- 片内总线
    - 芯片内部的总线（寄存器之间、寄存器与ALU之间）
- 系统总线
    - 数据总线
        - 特点
            - 双向传输
            - 位数与机器字长、存储字长有关
        - 传输内容
            - 数据、中断向量、状态信息、命令字（2011、2012）
    - 地址总线
        - 特点
            - 单向传输
            - 位数与主存地址空间的大小有关
        - 传输内容
            - 要访问的地址
    - 控制总线
        - 特点
            - 对于特定的一条控制总线传输是单向的
            - 但对于所有控制总线来看，传输是双向的
        - 传输内容
            - 读写、请求、响应、时钟信号、复位信号
- I/O总线
    - 连接中低速的I/O设备并通过I/O接口与系统总线相连接，目的是将低速设备与高速总线相分离（USB、PCI）
- 通信总线
    - 同步总线、异步总线
        - 下面6.2的总线定时细讲
    - 串行总线、并行总线
        - 串行总线抗干扰能力强，适合远距离传输
        - 并行总线抗干扰能力弱，但在近距离传输时速度很快
        - 串行并不一定比并行慢，现在的发展趋势是并行传输速度<<串行传输速度（2016）

### 3. 系统总线的结构

- 单总线结构
- 双总线结构
    - 主存总线+I/O总线
- 多总线结构
    - 主存总线+I/O总线+DMA总线

### 4. 常见的总线标准

- （PCI并行、PCI-E串行、USB串行）（真题中涉及到的：ISA、EISA、VESA、APG、USB、PCI-E） ![image](https://gitee.com/yao_yi_feng/fighouse/raw/master/img/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/202402242055169.webp)

### 5. 总线的性能指标

- 总线传输周期
    - 一次总线操作所需要的时间（包括申请阶段、寻址阶段、传输阶段和结束阶段）（经常考）
- 总线工作频率
    - 为总线传输周期的倒数（经常考）（现在有些总线一个时钟周期可以传输2次或4次数据）
- 总线时钟周期
    - 也就是机器的时钟周期
- 总线时钟频率
    - 为总线时钟周期的倒数
- 总线宽度
    - 总线上同时能够传输的数据位数
- 总线带宽
    - 可以理解为总线的最大数据传输率
    - 总线带宽=数据传输速率=总线频率*总线宽度=单位时间内传输的二进制信息位数（经常考）
- 总线传送方式
    - 非突发传输
        - 每次先传输地址，再传输数据
    - 突发传输
        - 每次传输一次地址，再传输多个数据（2014）
        - 可以提高同步总线数据传输率（2016、2018）

## 二、总线事务和定时

### 1. 总线事务

- 请求阶段-仲裁阶段-寻址阶段-传输阶段-释放阶段

### 2. 总线定时

- 同步式
    - 由统一的时钟信号进行协调，而不能由各设备提供（2015）
    - 提高同步总线带宽措施
        - 提高时钟频率、增加数据线宽度、支持突发传输、拆分总线事务、不采用分时复用（2018）
    - 优点
        - 控制逻辑简单、传输速度较快
    - 缺点
        - 总线定时以最慢设备所花时间为标准，所以只适合连接速度相差不大的设备
        - 由于时钟偏移问题总线的长度不能过长
- 异步式
    - 没有统一的时钟，也没有固定的时间间隔，靠“握手信号”实现定时控制
    - 特点：灵活、接口逻辑复杂、对噪声敏感、传输速度较慢
    - 分类
        - 不互锁（速率最快，最不可靠）（2015）
            - 请求----撤销请求
        - 半互锁（介于中间）
            - 请求----回答----撤销请求
        - 全互锁（速率最慢，最可靠）（2015）
            - 请求----回答----撤销请求----撤销回答
    - 图示
        - ![image](https://gitee.com/yao_yi_feng/fighouse/raw/master/img/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/202402242055363.webp)
- 半同步
    - 按照统一的时钟信号（同步特点），增加一条“等待”响应信号从而使不同速度的模块和谐工作（异步特点）（2015）

## 三、基于总线的互连结构（补充）

### 1. 图示

- （总线之间需要通过桥接器相连接） ![image](https://gitee.com/yao_yi_feng/fighouse/raw/master/img/408/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/202402242055381.webp)

### 2. 总线细节

- 前端总线
    - 速度最快的总线
    - QPI总线
        - 基于包的串行传输总线，连接不同CPU内核
        - 双向传输，每个时钟周期传输两次（2020）
        - 带宽=每秒传输次数_每次传输的有效数据_2（2020）
- 存储器总线
    - 注意多通道存储器，计算时带总带宽=单个通道宽*n（2019）
- I/O总线
    - 第一代
        - XT、ISA、EISA、VESA（这些总线早已被淘汰，了解即可）
    - 第二代
        - PCI、AGP、PCI-X
    - 第三代
        - PCI-Express
            - 采用串行传输方式（2017）
            - PCI-Express*n表示有n个通路，每个通路有两个差分信号线可以同时发送和接收数据
            - 在发送和接收时每个字节的数据被转换为10位信息被传输
            - 总线带宽=每个方向接收或发送速率_2_通路数/10